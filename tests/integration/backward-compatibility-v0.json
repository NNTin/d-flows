{
  "name": "v0 Backward Compatibility",
  "description": "Tests that releasing v1.0.0 doesn't break existing users who reference v0 in their workflows, and that a release/v0 branch is created for continued v0 maintenance. This validates critical requirement that releasing v1.0.0 doesn't break v0 users, ensures smooth transition with maintenance support, and allows users to upgrade at their own pace.",
  "steps": [
    {
      "name": "Setup complete release history",
      "action": "setup-git-state",
      "scenario": "FirstRelease",
      "expectedState": {
        "tags": [],
        "branches": ["main"],
        "currentBranch": "main"
      }
    },
    {
      "name": "Creating empty commit before release",
      "action": "execute-command",
      "command": "git commit --allow-empty -m 'Trigger release v0.1.0'"
    },
    {
      "name": "Execute v0.1.0 release workflow",
      "action": "run-workflow",
      "workflow": "release.yml",
      "fixture": "tests/release/valid-release-v0.1.0.json",
      "expectedOutputs": {
        "MAJOR_VERSION": "0"
      }
    },
    {
      "name": "Creating empty commit before release",
      "action": "execute-command",
      "command": "git commit --allow-empty -m 'Trigger release v0.2.0'"
    },
    {
      "name": "Execute v0.2.0 release workflow",
      "action": "run-workflow",
      "workflow": "release.yml",
      "fixture": "tests/release/valid-release-v0.2.0.json",
      "expectedOutputs": {
        "MAJOR_VERSION": "0"
      }
    },
    {
      "name": "Creating empty commit before release",
      "action": "execute-command",
      "command": "git commit --allow-empty -m 'Trigger release v0.2.1'"
    },
    {
      "name": "Execute v0.2.1 release workflow",
      "action": "run-workflow",
      "workflow": "release.yml",
      "fixture": "tests/release/valid-release-v0.2.1.json",
      "expectedOutputs": {
        "MAJOR_VERSION": "0"
      }
    },
    {
      "name": "Creating empty commit before release",
      "action": "execute-command",
      "command": "git commit --allow-empty -m 'Trigger release v0.2.2'"
    },
    {
      "name": "Execute v0.2.2 release workflow",
      "action": "run-workflow",
      "workflow": "release.yml",
      "fixture": "tests/release/valid-release-v0.2.2.json",
      "expectedOutputs": {
        "MAJOR_VERSION": "0"
      }
    },
    {
      "name": "Validate tags and branches",
      "action": "validate-state",
      "checks": [
        {"type": "tag-exists", "tag": "v0.1.0"},
        {"type": "tag-exists", "tag": "v0.2.0"},
        {"type": "tag-exists", "tag": "v0.2.1"},
        {"type": "tag-exists", "tag": "v0.2.2"},
        {"type": "tag-exists", "tag": "v0"},
        {"type": "tag-points-to", "tag": "v0", "target": "v0.2.2"},
        {"type": "workflow-success", "workflow": "release.yml"}
      ]
    },
    {
      "name": "Creating empty commit before release",
      "action": "execute-command",
      "command": "git commit --allow-empty -m 'Trigger release v1.0.0'"
    },
    {
      "name": "Execute major bump-version workflow",
      "action": "run-workflow",
      "workflow": "bump-version.yml",
      "fixture": "tests/bump-version/major-bump-v0-to-v1.json",
      "expectedOutputs": {
        "NEW_VERSION": "1.0.0",
        "FIRST_RELEASE": "false",
        "CURRENT_MAJOR": "0"
      },
      "expectedStepSummary": [
        "ðŸ”¼ major bump: 0.2.2 â†’ 1.0.0",
        "âœ… Version validation passed"
      ]
    },
    {
      "name": "Execute v1.0.0 release workflow",
      "action": "run-workflow",
      "workflow": "release.yml",
      "fixture": "tests/release/valid-release-v1.0.0.json",
      "expectedOutputs": {
        "MAJOR_VERSION": "1"
      }
    },
    {
      "name": "Validate v1 major tag exists",
      "action": "validate-state",
      "checks": [
        {"type": "branch-exists", "branch": "release/v0"},
        {"type": "branch-points-to-tag", "branch": "release/v0", "tag": "v0.2.2"},
        {"type": "tag-exists", "tag": "v1"},
        {"type": "tag-points-to", "tag": "v1", "target": "v1.0.0"}
      ]
    },
    {
      "name": "Validate all individual version tags accessible",
      "action": "validate-state",
      "checks": [
        {"type": "tag-accessible", "tag": "v0.1.0"},
        {"type": "tag-accessible", "tag": "v0.2.0"},
        {"type": "tag-accessible", "tag": "v0.2.1"},
        {"type": "tag-accessible", "tag": "v0.2.2"},
        {"type": "tag-accessible", "tag": "v1.0.0"}
      ]
    },
    {
      "name": "Validate tag coexistence",
      "action": "validate-state",
      "checks": [
        {"type": "major-tags-coexist", "tags": ["v0", "v1"]},
        {"type": "no-tag-conflicts"}
      ]
    },
    {
      "name": "Validate backward compatibility - v0 users unaffected",
      "action": "validate-state",
      "checks": [
        {"type": "tag-points-to", "tag": "v0", "target": "v0.2.2"},
        {"type": "tag-points-to", "tag": "v1", "target": "v1.0.0"}
      ]
    }
  ],
  "cleanup": {
    "action": "reset-git-state"
  },
  "expectedDuration": "30-60 seconds",
  "tags": ["integration", "backward-compatibility", "major-version-release", "v0-to-v1"]
}
