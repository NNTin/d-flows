name: "Install Red-DiscordBot"
description: "Downloads a Red-DiscordBot build artifact and installs it using uv."

inputs:
  artifact_name:
    description: "Optional artifact name to download. Default: red-discordbot-build"
    required: false

runs:
  using: "composite"
  steps:
    - name: Download Red-DiscordBot artifact
      if: env.ACT != 'true'  # Skip download when running with act
      uses: actions/download-artifact@v4
      with:
        name: ${{ inputs.artifact_name || 'red-discordbot-build' }}
        path: ./dist

    - name: Copy local artifact for act
      if: env.ACT == 'true'  # Copy local when running with act
      run: |
        mkdir -p ./dist
        cp ../Red-DiscordBot/dist/* ./dist/   # Adjust path to your built wheels

    - name: Set up Python 3.11
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: Install uv
      uses: astral-sh/setup-uv@v1

    - name: Install Red-DiscordBot
      shell: bash
      run: |
        uv install ./dist/*

    - name: Verify installation
      shell: bash
      run: |
        uvx python -c "import red; print('âœ… Red-DiscordBot installed successfully')"
